<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   
      <title>Advanced Trigger Setup</title>
      <meta name="generator" content="DocBook XSL-NS Stylesheets V1.75.2">
      <link rel="home" href="doc_tactic-setup.html" title="TACTIC Setup">
      <link rel="up" href="tactic-setup_advanced-automation.html" title="Advanced Automation">
      <link rel="prev" href="tactic-setup_setup_advanced-notification-setup.html" title="Advanced Notification Setup">
      <link rel="next" href="tactic-setup_expression-language.html" title="Expression Language">
   </head>
   <body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
      <div class="navheader">
         <table width="100%" summary="Navigation header">
            <tr>
               <td width="20%" align="left"><a accesskey="p" href="tactic-setup_setup_advanced-notification-setup.html">Prev</a>&nbsp;
               </td>
               <th width="60%" align="center">&nbsp;</th>
               <td width="20%" align="right">&nbsp;<a accesskey="n" href="tactic-setup_expression-language.html">Next</a></td>
            </tr>
         </table>
      </div>
      <div class="section" title="Advanced Trigger Setup">
         <div class="titlepage">
            <div>
               <div>
                  <h4 class="title"><a name="tactic-setup_setup_advanced-trigger-setup"></a>Advanced Trigger Setup
                  </h4>
               </div>
            </div>
         </div>
         <div class="simplesect" title="Description">
            <div class="titlepage">
               <div>
                  <div>
                     <h5 class="title"><a name="d0e6848"></a>Description
                     </h5>
                  </div>
               </div>
            </div>
            <p>Examples of how to set up a client side trigger.</p>
         </div>
         <div class="simplesect" title="Options">
            <div class="titlepage">
               <div>
                  <div>
                     <h5 class="title"><a name="d0e6853"></a>Options
                     </h5>
                  </div>
               </div>
            </div>
            <p>Different types of database events cause the client trigger to be fired. </p>
            <p>These include the following events: accept, update.  </p>
         </div>
         <div class="simplesect" title="How To Create a Client Side Trigger">
            <div class="titlepage">
               <div>
                  <div>
                     <h5 class="title"><a name="d0e6860"></a>How To Create a Client Side Trigger
                     </h5>
                  </div>
               </div>
            </div>
            <p><span class="bold"><strong>Example 1: Simple Javascript Alert</strong></span></p>
            <p>
                               
            </p>
            <div class="orderedlist">
               <ol class="orderedlist" type="1">
                  <li class="listitem">
                     <p>Open the Client Trigger view under: Admin Views -&gt; Project Essentials -&gt; <span class="bold"><strong>Client </strong></span>Triggers
                     </p>
                  </li>
                  <li class="listitem">
                     <p>Add the following new entry:</p>
                     <p>
                                                    
                     </p>
                     <div class="informaltable">
                        <table border="1">
                           <colgroup>
                              <col>
                              <col>
                           </colgroup>
                           <tbody>
                              <tr>
                                 <td>
                                                                                    
                                    <p><span class="bold"><strong>Event</strong></span></p>
                                                                                
                                 </td>
                                 <td>accept|my_project/my_sType</td>
                              </tr>
                              <tr>
                                 <td>
                                                                                    
                                    <p><span class="bold"><strong>Callback</strong></span></p>
                                                                                
                                 </td>
                                 <td>my_script_folder/my_client_side_script</td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <p>
                                                
                     </p>
                  </li>
                  <li class="listitem">
                     <p>Open the Script Editor (keyboard short-cut is "9") and create the
                                                    following entry:
                     </p>
                     <p>
                                                    
                     </p>
                     <div class="informaltable">
                        <table border="1">
                           <colgroup>
                              <col>
                              <col>
                           </colgroup>
                           <tbody>
                              <tr>
                                 <td>
                                                                                    
                                    <p><span class="bold"><strong>Script
                                                                                               Path</strong></span></p>
                                                                                
                                 </td>
                                 <td>my_script_folder/my_client_side_script</td>
                              </tr>
                              <tr>
                                 <td>
                                                                                    
                                    <p><span class="italic">script
                                                                                            type</span></p>
                                                                                
                                 </td>
                                 <td>javascript</td>
                              </tr>
                              <tr>
                                 <td>
                                                                                    
                                    <p><span class="italic">code</span></p>
                                                                                
                                 </td>
                                 <td>log.critical(input)</td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <p>
                                                
                     </p>
                  </li>
                  <li class="listitem">
                     <p>Go to the view of the sType my_project/my_sType.</p>
                  </li>
                  <li class="listitem">
                     <p>Refresh the tab if the view is stale.</p>
                  </li>
                  <li class="listitem">
                     <p>Modify an entry and click off the field. The changed cell should turn
                                                green.
                     </p>
                     <p>Notice in the web browser Javascript console output, the contents of
                                                the input object is displayed. You can access useful information in there
                                                like search key by specifying "input.search_key".
                     </p>
                  </li>
               </ol>
            </div>
            <p>
                           
            </p>
            <p><span class="bold"><strong>Example 2: Refresh the row after it is
                                 saved</strong></span></p>
            <p>
                               
            </p>
            <div class="orderedlist">
               <ol class="orderedlist" type="1">
                  <li class="listitem">
                     <p>Open the Client Trigger view under: Admin Views -&gt; Project Essentials
                                                    -&gt; <span class="bold"><strong>Client </strong></span>Triggers
                     </p>
                  </li>
                  <li class="listitem">
                     <p>Add  the following new entry:</p>
                     <p>
                                                    
                     </p>
                     <div class="informaltable">
                        <table border="1">
                           <colgroup>
                              <col>
                              <col>
                           </colgroup>
                           <tbody>
                              <tr>
                                 <td>
                                                                                    
                                    <p><span class="bold"><strong>Event</strong></span></p>
                                                                                
                                 </td>
                                 <td>update|my_project/my_sType2</td>
                              </tr>
                              <tr>
                                 <td>
                                                                                    
                                    <p><span class="bold"><strong>Callback</strong></span></p>
                                                                                
                                 </td>
                                 <td>my_script_folder/my_client_side_script2</td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <p>
                                                
                     </p>
                  </li>
                  <li class="listitem">
                     <p>Open the Script Editor (keyboard short-cut is "9") and create the
                                                following entry:
                     </p>
                     <p>
                                                
                     </p>
                     <div class="informaltable">
                        <table border="1">
                           <colgroup>
                              <col>
                              <col>
                           </colgroup>
                           <tbody>
                              <tr>
                                 <td>
                                                                                
                                    <p><span class="bold"><strong>Script
                                                                                             Path</strong></span></p>
                                                                            
                                 </td>
                                 <td>my_script_folder/my_client_side_script2</td>
                              </tr>
                              <tr>
                                 <td>
                                                                                
                                    <p><span class="italic">script
                                                                                          type</span></p>
                                                                            
                                 </td>
                                 <td>javascript</td>
                              </tr>
                              <tr>
                                 <td>
                                                                                
                                    <p><span class="italic">code</span></p>
                                                                            
                                 </td>
                                 <td>(see code below)</td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <p>
                                            
                     </p>
                     <p>
                                                
                     </p>
                     <div class="sidebar">
                        <p class="title"><b></b></p><pre class="screen">
log.critical(input);
if (input.kwargs) {
    var search_key = input.kwargs.search_keys[0];

    var update_data = input.kwargs.update_data;
    var update_dict = eval(input.kwargs.update_data);
    var prev_description = update_dict[0]["description"];
    var server = TacticServerStub.get();

    // Append the word 'Hello' to the description.
    var data = {'description': prev_description + ' Hello'};

    server.update(search_key, data);
}
</pre></div>
                     <p>
                                            
                     </p>
                  </li>
                  <li class="listitem">
                     <p>Go to the view of the sType my_project/my_sType2.</p>
                  </li>
                  <li class="listitem">
                     <p>Refresh the tab if the view is stale.</p>
                  </li>
                  <li class="listitem">
                     <p>Modify an entry's description field. Try typing in "This is test" and
                                                save.
                     </p>
                     <p>Notice that after the entry is saved, and when you refresh the view, the
                                                description has the word "Hello" appended to it.
                     </p>
                  </li>
               </ol>
            </div>
            <p>
                           
            </p>
            <p><span class="bold"><strong>Example 3: Automatically Put all Field Text into CAPS after
                                     Editing (When Row Turns Green)</strong></span></p>
            <p>
                           
            </p>
            <div class="orderedlist">
               <ol class="orderedlist" type="1">
                  <li class="listitem">
                     <p>Open the Client Trigger view under: Admin Views -&gt; Project Essentials -&gt;
                                                    <span class="bold"><strong>Client </strong></span>Triggers
                     </p>
                  </li>
                  <li class="listitem">
                     <p>Add the following new entry:</p>
                     <p>
                                                
                     </p>
                     <div class="informaltable">
                        <table border="1">
                           <colgroup>
                              <col>
                              <col>
                           </colgroup>
                           <tbody>
                              <tr>
                                 <td>
                                                                                
                                    <p><span class="bold"><strong>Event</strong></span></p>
                                                                            
                                 </td>
                                 <td>accept|my_project/my_sType3</td>
                              </tr>
                              <tr>
                                 <td>
                                                                                
                                    <p><span class="bold"><strong>Callback</strong></span></p>
                                                                            
                                 </td>
                                 <td>my_script_folder/my_client_side_script3</td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <p>
                                            
                     </p>
                  </li>
                  <li class="listitem">
                     <p>Open the Script Editor (keyboard short-cut is "9") and create the
                                                following entry:
                     </p>
                     <div class="informaltable">
                        <table border="1">
                           <colgroup>
                              <col>
                              <col>
                           </colgroup>
                           <tbody>
                              <tr>
                                 <td>
                                                                                
                                    <p><span class="bold"><strong>Script
                                                                                             Path</strong></span></p>
                                                                            
                                 </td>
                                 <td>my_script_folder/my_client_side_script3</td>
                              </tr>
                              <tr>
                                 <td>
                                                                                
                                    <p><span class="italic">script
                                                                                          type</span></p>
                                                                            
                                 </td>
                                 <td>javascript</td>
                              </tr>
                              <tr>
                                 <td>
                                                                                
                                    <p><span class="italic">code</span></p>
                                                                            
                                 </td>
                                 <td>(see code below)</td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <p>
                                                
                     </p>
                     <div class="sidebar">
                        <p class="title"><b></b></p><pre class="screen">
// Applies caps to Name column in my_sType3 sType

try{
    var server = TacticServerStub.get();

    var column_name = input.element_name;

    // only affect Name column
    if (column_name == "name") {
        var column_data = input.new_value;

        column_data = column_data.toUpperCase();
        
        input.cell.setAttribute('spt_input_value', column_data);
        spt.table.set_display(input.cell, column_data, 'text');
    }
        
}catch( e ){
    spt.alert(spt.exception.handler( e ));
}

</pre></div>
                     <p>
                                            
                     </p>
                  </li>
                  <li class="listitem">
                     <p>Go to the view of the sType my_project/my_sType3.</p>
                  </li>
                  <li class="listitem">
                     <p>Refresh the tab if the view is stale.</p>
                  </li>
                  <li class="listitem">
                     <p>From the code example provided, modify an entry's name field. Change the
                                                text in the name field to "Tester" and the row should turn green. Be sure to
                                                save the change. 
                     </p>
                     <p>Notice that after the entry is saved, the text in the name field will now
                                                appear as "TESTER".
                     </p>
                  </li>
               </ol>
            </div>
            <p>
                       
            </p>
            <p><span class="bold"><strong>Example 4: Look at Name Values in Table through a Lookahead and
                                     Pop Up a Form with Details</strong></span></p>
            <p>
                           
            </p>
            <div class="orderedlist">
               <ol class="orderedlist" type="1">
                  <li class="listitem">
                     <p>Open the Client Trigger view under: Admin Views -&gt; Project Essentials -&gt;
                                                    <span class="bold"><strong>Client </strong></span>Triggers
                     </p>
                  </li>
                  <li class="listitem">
                     <p>Add the following new entry:</p>
                     <p>
                                                
                     </p>
                     <div class="informaltable">
                        <table border="1">
                           <colgroup>
                              <col>
                              <col>
                           </colgroup>
                           <tbody>
                              <tr>
                                 <td>
                                                                                
                                    <p><span class="bold"><strong>Event</strong></span></p>
                                                                            
                                 </td>
                                 <td>lookahead|my_project/my_sType4</td>
                              </tr>
                              <tr>
                                 <td>
                                                                                
                                    <p><span class="bold"><strong>Callback</strong></span></p>
                                                                            
                                 </td>
                                 <td>my_script_folder/my_client_side_script4</td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <p>
                                            
                     </p>
                  </li>
                  <li class="listitem">
                     <p>Open the Script Editor (keyboard short-cut is "9") and create the
                                                following entry:
                     </p>
                     <div class="informaltable">
                        <table border="1">
                           <colgroup>
                              <col>
                              <col>
                           </colgroup>
                           <tbody>
                              <tr>
                                 <td>
                                                                                
                                    <p><span class="bold"><strong>Script
                                                                                             Path</strong></span></p>
                                                                            
                                 </td>
                                 <td>my_script_folder/my_client_side_script4</td>
                              </tr>
                              <tr>
                                 <td>
                                                                                
                                    <p><span class="italic">script
                                                                                          type</span></p>
                                                                            
                                 </td>
                                 <td>javascript</td>
                              </tr>
                              <tr>
                                 <td>
                                                                                
                                    <p><span class="italic">code</span></p>
                                                                            
                                 </td>
                                 <td>(see code below)</td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <p>NOTE: The code below is an example written to look for names of people in
                                                an sType table and pop up a form with details about the person. The details
                                                form would be created in the Custom Layout Editor. In the example, the view
                                                is called my_project.name_detail.popup. Ensure that all values that should
                                                be displayed as part of the details in the form are also pulled from the
                                                sType table i.e. age.
                     </p>
                     <p>
                                                
                     </p>
                     <div class="sidebar">
                        <p class="title"><b></b></p><pre class="screen">
try{
    server = TacticServerStub.get();
    
    var class_name = 'tactic.ui.panel.CustomLayoutWdg';
    
    
    var search_type = 'my_project/my_sType4';
    var name = input.display;
    var name_id = input.value;
    if (!name)
        input.value = null;
    
    var form_table = input.firing_element.getParent(".spt_form_table");
    var last_input_name = form_table.getElement('.spt_last_input_name');
    var last_names = last_input_name.value.split('||');
    // Check if the current name input is what was typed in last
    var reused_name = false;
    // Check if the current name is unknown in my_sType4 table
    var unknown_name = false;
    if (last_names.length == 2) {
        reused_name = last_names[0] == name;
        unknown_name = (last_names[1] == name_id )&amp;&amp; (last_names[0] != name);
      
    }
    if (!name || name_id == '' || name_id === null || reused_name || unknown_name) {
    }
    else{
        var kwargs = {
        'view': 'my_project.name_detail.popup',
        'name_id': name_id
        };
        
        // Load the popup
        var pop = spt.panel.load_popup("Name Details", class_name, kwargs);
        last_input_name.value = name + '||' + name_id;
        pop.activator = form_table;
    }

}catch( e ){
    spt.alert(spt.exception.handler( e ));
}
</pre></div>
                     <p>
                                            
                     </p>
                  </li>
                  <li class="listitem">
                     <p>In order to have a lookahead that will look at the my_sType4 table, a
                                                lookahead must be built within a custom view i.e. my_views/lookahead_form in
                                                the Custom Layout Editor (this will be a different view from the
                                                aforementioned name details form). An example of the code required to create
                                                this view is shown below.
                     </p>
                     <p><span class="italic">HTML Tab in Custom Layout Editor for New
                                                       View</span></p>
                     <div class="sidebar">
                        <p class="title"><b></b></p><pre class="screen">
&lt;div&gt;
  &lt;div&gt;
&lt;%
name_key = kwargs.get("search_key") or ""
%&gt;
&lt;/div&gt;
  &lt;table&gt;
    &lt;tr&gt;
      &lt;td&gt;Name&lt;/td&gt;
      &lt;td&gt;
        &lt;element name="name"&gt;
          &lt;display class="tactic.ui.input.LookAheadTextInputWdg"&gt;
            &lt;search_type&gt;my_project/my_sType4&lt;/search_type&gt;
            &lt;column&gt;name&lt;/column&gt;
            &lt;search_key&gt;${name_key}&lt;/search_key&gt;
            &lt;filter_search_type&gt;metadata/Title&lt;/filter_search_type&gt;
            &lt;value_column&gt;id&lt;/value_column&gt;
            &lt;current_value_column&gt;id&lt;/current_value_column&gt;
          &lt;/display&gt;
        &lt;/element&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
  &lt;/table&gt;
&lt;/div&gt;
</pre></div>
                  </li>
                  <li class="listitem">
                     <p>Go to the my_views/lookahead_form in Custom Layout Editor and click on the
                                                "Test" button to test the fucntionality of the view. The view can also be
                                                added to the sidebar.
                     </p>
                  </li>
                  <li class="listitem">
                     <p>In the view, begin typing a name. A list of different name values from the
                                                my_sType4 table should appear in a drop down from the lookahead.
                     </p>
                  </li>
                  <li class="listitem">
                     <p>Clicking on one of the values in the drop down of the lookahead will then
                                                pop up the my_project.name_detail.popup with all of the values from the
                                                external system.
                     </p>
                  </li>
               </ol>
            </div>
            <p>
                       
            </p>
         </div>
      </div>
      <div class="navfooter">
         <hr>
         <table width="100%" summary="Navigation footer">
            <tr>
               <td width="40%" align="left"><a accesskey="p" href="tactic-setup_setup_advanced-notification-setup.html">Prev</a>&nbsp;
               </td>
               <td width="20%" align="center"><a accesskey="u" href="tactic-setup_advanced-automation.html">Up</a></td>
               <td width="40%" align="right">&nbsp;<a accesskey="n" href="tactic-setup_expression-language.html">Next</a></td>
            </tr>
            <tr>
               <td width="40%" align="left" valign="top">&nbsp;</td>
               <td width="20%" align="center"><a accesskey="h" href="doc_tactic-setup.html">Home</a></td>
               <td width="40%" align="right" valign="top">&nbsp;</td>
            </tr>
         </table>
      </div>
   </body>
</html>